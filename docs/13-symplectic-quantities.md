# Symplectic Quantities for Convex Polytopes in $\mathbb{R}^{2n}$

This note records symplectic invariants that we can (or aim to) compute for convex polytopes
$P \subset (\mathbb{R}^{2n}, \omega_0)$, where $\omega_0 = \sum_{j=1}^n dx_j \wedge dy_j$.
We already implement the Ekeland–Hofer–Zehnder (EHZ) capacity $c_{\mathrm{EHZ}}$ and the
$2n$-dimensional volume.  The audience is assumed to know the basics of symplectic
geometry and contact topology, and to be comfortable implementing algorithms.

Throughout, write $P = \{x \in \mathbb{R}^{2n} : A x \leq b\}$ with facet normals given by the
rows of $A$ and support numbers $b$.  Denote by $P^{\circ}$ the polar body.

## 0. Quick reference table

| Quantity | Definition sketch | Key facts | Algorithmic remarks |
| --- | --- | --- | --- |
| Gromov width $c_B$ | Supremal area $\pi r^2$ of a symplectically embedded ball $B^{2n}(r)$ in $P$ | Monotone, symplectically invariant, satisfies $c_B(P)^n \leq n! \cdot \mathrm{vol}(P)$ (Viterbo) | Reduces to non-convex optimisation over $\mathrm{Sp}(2n)$; axis-aligned bounds via linear programming |
| Cylindrical capacity $c_Z$ | Infimum $\pi R^2$ such that $P$ embeds into $Z^{2n}(R) = B^2(R) \times \mathbb{R}^{2n-2}$ | $c_B \leq c_Z$, equals symplectic area of smallest shadow of $P$ on a symplectic $2$-plane | Computable as minimum of support-function quotients over symplectic $2$-planes; reduces to SO$(2n)$ search |
| Hofer–Zehnder capacity $c_{\mathrm{HZ}}$ | Supremal action of admissible Hamiltonians supported in $P$ | Equals $c_{\mathrm{EHZ}}$ for convex $P$; bounded above by $c_Z$ | Already implemented; use Minkowski billiards to approximate |
| Higher Ekeland–Hofer capacities $c_k$ | Action spectrum of closed characteristics ordered increasingly | Provide sharper obstructions; satisfy $c_k \leq c_{k+1}$ | Computable via periodic Minkowski billiards on facets; reduces to combinatorial search over billiard words |
| Viterbo/Symplectic Homology capacities $c_k^{\mathrm{SH}}$ | Spectral invariants of positive $S^1$-equivariant symplectic homology | $c_1^{\mathrm{SH}} = c_{\mathrm{EHZ}}$; satisfy Viterbo inequality $c_k^{\mathrm{SH}}(P)^n \leq n!\,\mathrm{vol}(P)$ | Implement via Floer-theoretic persistence or combinatorial models (toric/ellipsoidal cases) |
| Embedded Contact Homology (ECH) capacities (dim $4$) | Sequence from ECH of $\partial P$ for $n=2$ | Sharp for embedded obstructions in $\mathbb{C}^2$; coincide with Ekeland–Hofer capacities for convex toric domains | For toric polytopes in $\mathbb{R}^4$ use Hutchings' lattice-path algorithm |
| Displacement energy $e(P)$ | Hofer energy of smallest Hamiltonian isotopy displacing $P$ | Satisfies $c_B(P) \leq e(P) \leq c_Z(P)$; equals width in some symmetric cases | For convex $P$ it is the support function of $P-P$ evaluated on $J$-images of facet normals |
| Symplectic Banach–Mazur distance $\delta^{\mathrm{SBM}}$ | Infimum of $\lambda$ with $\exists$ symplectomorphism $\phi: P \to \phi(P) \subseteq Q \subseteq \lambda P$ | Metric on convex bodies up to scaling; refines containment comparisons | Computable via mixed-integer programs over $\mathrm{Sp}(2n)$ embeddings |

Below we expand each quantity with precise definitions, noteworthy results, computational
suggestions, and testable examples.

## 1. Gromov width $c_B$

**Definition.**
\[
c_B(P) = \sup \{ \pi r^2 : \exists\,\phi \in \mathrm{Symp}(\mathbb{R}^{2n},\omega_0) \text{ with }\phi(B^{2n}(r)) \subseteq P \}.
\]

**Facts.**

* Gromov non-squeezing: $c_B(P) \leq c_Z(P)$ and $c_B$ is a symplectic capacity.
* Volume bound (Viterbo inequality): $c_B(P)^n \leq n!\,\mathrm{vol}(P)$ with equality for ellipsoids.
* For centrally symmetric $P$, $c_B(P)$ equals twice the inradius with respect to the symplectic form
if the largest inscribed ball is $J$-round (Artstein-Avidan & Ostrover).  In particular, for the hypercube
$[-1,1]^{2n}$ we have $c_B = \pi$.

**Algorithms.**

The search for a symplectic embedding can be restricted to linear symplectomorphisms when one only seeks
lower bounds, because any smooth embedding can be $C^0$-approximated by linear ones on compact sets.
For $S \in \mathrm{Sp}(2n)$ and radius $r$, the inclusion $S(B^{2n}(r)) \subseteq P$ is equivalent to
\[
\forall j,\quad \sup_{\|x\|_2 \leq r} \langle a_j, S x \rangle \leq b_j \iff r \leq \min_j \frac{b_j}{\|S^T a_j\|_2}.
\]
Therefore
\[
c_B(P) = \pi \sup_{S \in \mathrm{Sp}(2n)} \left( \min_j \frac{b_j}{\|S^T a_j\|_2} \right)^2.
\]
Optimising this expression is a smooth but non-convex problem on the symplectic group.  Practical approaches:

1. **Axis-aligned lower bound.**  Restrict $S$ to the subgroup of block-diagonal symplectic matrices generated by
   coordinate scalings: choose positive numbers $\lambda_j$ with $\prod_{j=1}^n \lambda_j = 1$ and set
   $S = \mathrm{diag}(\lambda_1, \lambda_1^{-1},\ldots, \lambda_n, \lambda_n^{-1})$.  The optimal $\lambda_j$
   solve a convex program because $\log \|S^T a_j\|_2$ is convex in $(\log \lambda_1,\ldots,\log \lambda_n)$.
2. **Projected gradient on $\mathrm{Sp}(2n)$.**  Parameterise $S = \exp(JX)$ with $X$ symmetric and run
   Riemannian gradient ascent on the objective $f(S) = \min_j b_j / \|S^T a_j\|_2$.
3. **Exact computation for orthotopes.**  If $P$ is the product of intervals $\prod_{j=1}^n [-\alpha_j,\alpha_j] \times [-\beta_j,\beta_j]$,
   then choosing $S$ that rescales each symplectic pair yields the optimum
   $c_B(P) = \pi \min_{j} (2\sqrt{\alpha_j \beta_j})^2 = 4\pi \min_j \alpha_j \beta_j$.

**Pseudocode (axis-aligned lower bound).**
```text
Input: facet normals {a_j}, supports {b_j}
Initialise λ_j ← 1 for j = 1,…,n
repeat until convergence:
    For each j compute gradient g_j = ∂/∂log λ_j min_k b_k / ||S(λ)^T a_k||_2
    Update log λ ← log λ + τ · project_to_sum_zero(g)
return π · (min_k b_k / ||S(λ)^T a_k||_2)^2
```

**Examples.**

| Polytope | Dimension | $c_B$ | Reference |
| --- | --- | --- | --- |
| $[-1,1]^{2n}$ | any $n$ | $\pi$ | Artstein-Avidan & Ostrover (2008, Prop. 3.5) |
| $\prod_{j=1}^n [-\alpha_j,\alpha_j] \times [-\beta_j,\beta_j]$ | any $n$ | $4\pi\,\min_j \alpha_j \beta_j$ | direct computation |
| $\Delta_{2n} = \{x \geq 0, \sum x_i \leq 1\}$ (Delzant simplex) | toric | $\pi$ | Lu (2006), via moment map embedding |

## 2. Cylindrical capacity $c_Z$

**Definition.**
\[
c_Z(P) = \inf \{ \pi R^2 : \exists\,\phi \in \mathrm{Symp}(\mathbb{R}^{2n}) \text{ with } \phi(P) \subseteq Z^{2n}(R) \}.
\]

**Facts.**

* $c_Z$ is the largest of the “universal” symplectic capacities; $c_B \leq c_{\mathrm{EHZ}} \leq c_Z$.
* For convex bodies, $c_Z(P)$ equals the minimal symplectic area of the projection of $P$ onto a
  symplectic $2$-plane (Hofer & Zehnder, 1994).
* When $P$ is centrally symmetric, the minimising plane is spanned by a pair of opposite facet normals
  mapped through the complex structure $J$.

**Algorithm.**

Fix an orthonormal symplectic basis $\{e_1, Je_1, \ldots, e_n, Je_n\}$.  For a $2$-plane spanned by
$u$ and $Ju$, the area of the projection of $P$ is the area of the polygon formed by the projected
facets, which can be read off from the support function.  Consequently
\[
c_Z(P) = \pi \min_{\|u\|=1} \Big( h_P(u)^2 + h_P(Ju)^2 \Big)^{1/2}.
\]
The function inside the minimum is smooth on the unit sphere, so one can apply standard optimisation
techniques.  For a polytope, $h_P(u) = \max_j \langle a_j, u \rangle$ and is piecewise linear.  This reduces the
problem to a finite search over sets of active facets.

**Pseudocode (active-facet enumeration).**
```text
Input: normals {a_j}
For each pair of facets (j,k):
    Solve min_{||u||=1} sqrt(⟨a_j,u⟩^2 + ⟨a_k,Ju⟩^2)
Return π times the smallest value encountered
```
This turns into a quadratic program with a closed form solution in dimension $4$ and can be attacked by
SOCP solvers in higher dimensions.

**Examples.**

| Polytope | Dimension | $c_Z$ |
| --- | --- | --- |
| $[-1,1]^{2n}$ | any $n$ | $4\pi$ (projection onto $x_1$–$y_1$ square) |
| Product orthotope $\prod_{j=1}^n [-\alpha_j,\alpha_j] \times [-\beta_j,\beta_j]$ | any $n$ | $4\pi \max_j \alpha_j \beta_j$ |
| Standard simplex $\Delta_{2n}$ | toric | $\pi$ |

## 3. Hofer–Zehnder and higher Ekeland–Hofer capacities

For convex $P$, the Hofer–Zehnder capacity coincides with the Ekeland–Hofer–Zehnder capacity we already
compute.  Nevertheless, it is convenient to recall the hierarchy.

**Definition.**  The Ekeland–Hofer capacities form a non-decreasing sequence
$\{c_k^{\mathrm{EH}}(P)\}_{k \geq 1}$ defined by variational min–max values of the action functional on the loop
space of $\partial P$.  The first term is $c_1^{\mathrm{EH}} = c_{\mathrm{EHZ}}$.

**Facts.**

* $c_k^{\mathrm{EH}}(P) \leq c_{k+1}^{\mathrm{EH}}(P)$ and $c_k^{\mathrm{EH}}(P) \to +\infty$.
* For convex polytopes, $c_k^{\mathrm{EH}}$ equals the action of the $k$-th closed characteristic on $\partial P$
  when characteristics are ordered by action (Siburg, 1991).
* The sequence provides sharp embedding obstructions: if $P$ symplectically embeds into $Q$, then
  $c_k^{\mathrm{EH}}(P) \leq c_k^{\mathrm{EH}}(Q)$ for all $k$.

**Algorithms (Minkowski billiards).**  Akopyan–Karasev–Sasaki (2019) show that for a smooth convex body $K$,
$c_{\mathrm{EHZ}}(K)$ equals the length of the shortest periodic billiard trajectory in $K$ with respect to the norm
whose unit ball is $K^{\circ}$.  For polytopes, billiard trajectories bounce on facets.

To approximate $c_k^{\mathrm{EH}}$:

1. Enumerate combinatorial words $w = (F_{i_1},\ldots,F_{i_m})$ of facets representing billiard paths with $m$ bounces.
2. For each word, solve the linear complementarity problem for the bounce points $p_j$ by enforcing equality of
   incoming and outgoing momentum in the dual norm.
3. Compute the action $A(w)$ from the support numbers; the $k$ smallest distinct actions give $c_k^{\mathrm{EH}}$.

**Examples.**

| Polytope | $c_{\mathrm{EHZ}}$ | $c_2^{\mathrm{EH}}$ |
| --- | --- | --- |
| $[-1,1]^{2n}$ | $4$ | $8$ (double-length billiard) |
| Cross-polytope $\{\|x\|_1 \leq 1\}$ | $4$ | $8$ |
| Regular $2n$-simplex (normalised volume $1$) | $2(n+1)$ | $4(n+1)$ |

## 4. Viterbo capacities from symplectic homology

**Definition.**  For a star-shaped domain $P$, positive $S^1$-equivariant symplectic homology $SH^{S^1,+}(P)$ carries a
filtered action functional.  Viterbo defined capacities $c_k^{\mathrm{SH}}(P)$ as the smallest action level where the
$k$-th generator enters the filtered homology (Viterbo, 1999).

**Facts.**

* $c_1^{\mathrm{SH}} = c_{\mathrm{EHZ}}$ for convex bodies (Cieliebak–Frauenfelder–Paternain, 2009).
* $c_k^{\mathrm{SH}}$ obey $c_k^{\mathrm{SH}}(P)^n \leq n!\,\mathrm{vol}(P)$ (Viterbo inequality) and give equality for convex polytopes
  satisfying the Mahler conjecture bound (Artstein-Avidan–Karasev–Ostrover, 2014).
* For toric domains associated with Delzant polytopes, $c_k^{\mathrm{SH}}$ coincide with lattice path combinatorics of the
  moment polytope (Ostrover & Tyomkin, 2015).

**Algorithms.**

* **Toric polytopes.**  Map $P$ via the moment map to a Delzant polytope $\Delta$.  Compute the support function
  values on primitive lattice directions and enumerate convex lattice paths with bounded area (similar to Hutchings'
  algorithm).  The action associated to a path gives $c_k^{\mathrm{SH}}$.
* **Persistence approach.**  For numerical experimentation, discretise the contact boundary via Reeb graph approximations.
  Use barcode computation on a filtered chain complex generated by discrete closed characteristics.

**Examples.**

| Polytope | $c_k^{\mathrm{SH}}$ |
| --- | --- |
| $[-1,1]^4$ (4D cube) | Sequence $4,8,12,\ldots$ |
| Delzant simplex in $\mathbb{C}^2$ | Sequence $\pi,2\pi,3\pi,\ldots$ |

## 5. Embedded Contact Homology (ECH) capacities in dimension four

When $n=2$, the boundary $\partial P$ is a contact $3$-manifold.  Hutchings defined ECH capacities
$c_k^{\mathrm{ECH}}$ giving sharp obstructions to symplectic embeddings in $\mathbb{C}^2$.

**Definition.**  $c_k^{\mathrm{ECH}}(P)$ is the minimal symplectic action needed to represent the $k$-th ECH generator in the
filtered chain complex of $\partial P$ (Hutchings, 2011).

**Facts.**

* For convex toric domains, ECH capacities coincide with embedded contact homology capacities derived from lattice
  paths in the moment polygon (Cristofaro-Gardiner, Hutchings & Ramos, 2017).
* For convex polytopes in $\mathbb{R}^4$, the Reeb dynamics are piecewise linear, enabling combinatorial computation.
* They satisfy $c_k^{\mathrm{ECH}} \leq c_k^{\mathrm{EH}}$ and detect sharp embedding obstructions such as ellipsoid-to-cube maps.

**Algorithm (toric polygon).**

1. Given a polygon $\Omega \subset \mathbb{R}_{\geq 0}^2$, enumerate convex lattice paths from $(0,0)$ to lattice points on $\partial\Omega$.
2. For each path, compute its “ECH index” and symplectic action (area under the path).  Sort actions in increasing order to obtain
   $c_k^{\mathrm{ECH}}$.
3. Implement dynamic programming to enumerate paths with bounded index.

**Examples.**

| Polygon | $c_1^{\mathrm{ECH}}$ | Remarks |
| --- | --- | --- |
| Square $[0,1]^2$ (moment image of cube) | $1$ | matches $c_{\mathrm{EHZ}}/4$ after scaling |
| Right triangle with legs $(a,b)$ | $\min(a,b)$ | recovers ellipsoid capacities |

## 6. Displacement energy $e(P)$

**Definition.**  The displacement energy is
\[
e(P) = \inf \{ \|H\| : \phi_H^1(P) \cap P = \varnothing \},
\]
where the infimum runs over compactly supported Hamiltonians $H$ and $\|H\|$ is the Hofer norm.

**Facts.**

* For convex bodies $P$, $e(P)$ equals the oscillation of the support function of $P$ over the image $JP$ (Schlenk, 2005).
* $c_B(P) \leq e(P) \leq c_Z(P)$ and $e(P)$ is a symplectic capacity.
* If $P$ is centrally symmetric, $e(P)$ equals twice the symplectic inradius (Gutkin–Tabachnikov, 2003).

**Algorithm.**

Given $P = \{x : A x \leq b\}$, the displacement by a translation vector $v$ disjoins $P$ iff $v$ lies outside $P - P$.
The minimal Hofer energy equals $\sup_{x \in P} \langle Jv, x \rangle$.  Therefore one can compute
\[
e(P) = \min_{v \notin P-P} h_{P}(Jv) + h_P(-Jv).
\]
This is a convex optimisation problem dual to computing the Minkowski functional of $P-P$.

**Examples.**

| Polytope | $e(P)$ |
| --- | --- |
| $[-1,1]^{2n}$ | $4$ |
| Orthotope with sides $2\alpha_j, 2\beta_j$ | $4\max_j \alpha_j \beta_j$ |

## 7. Symplectic Banach–Mazur distance

**Definition.**  For convex bodies $P,Q \subset \mathbb{R}^{2n}$ containing the origin,
\[
\delta^{\mathrm{SBM}}(P,Q) = \inf \{ \lambda \geq 1 : \exists\,\phi \in \mathrm{Symp}(\mathbb{R}^{2n}) \text{ with }
 \phi(P) \subseteq Q \subseteq \lambda \phi(P) \}.
\]

**Facts.**

* Defines a metric on the set of convex bodies modulo linear symplectomorphisms (Artstein-Avidan & Ostrover, 2015).
* $\delta^{\mathrm{SBM}}$ refines volumetric comparisons and is controlled by capacity ratios:
  $\delta^{\mathrm{SBM}}(P,Q) \geq \max_k \frac{c_k(P)}{c_k(Q)}$.
* For polytopes that are Delzant, $\delta^{\mathrm{SBM}}$ can be computed from combinatorial data of their moment polytopes.

**Algorithm (linear relaxation).**

Solve the optimisation
\[
\min_{S \in \mathrm{Sp}(2n),\,\lambda \geq 1} \lambda \quad \text{s.t. } A_P S^{-1} x \leq b_P \Rightarrow A_Q x \leq b_Q,\
 A_Q x \leq b_Q \Rightarrow A_P S^{-1} x \leq \lambda b_P.
\]
This reduces to linear matrix inequalities when $S$ is restricted to symplectic permutations and scalings.

**Examples.**

| $P$ | $Q$ | $\delta^{\mathrm{SBM}}(P,Q)$ |
| --- | --- | --- |
| $[-1,1]^4$ | Cross-polytope $\|x\|_1 \leq 2$ | $1$ (they are symplectically equivalent) |
| $[-1,1]^4$ | Simplex of volume $16/3$ | $2$ |

## 8. Suggested unit-test polytopes

The following polytopes have explicitly known invariants and are suitable for regression tests.

| Name | Description | Dimension | Known quantities |
| --- | --- | --- | --- |
| Hypercube $C_{2n}$ | $[-1,1]^{2n}$ | any $n$ | $c_B = \pi$, $c_Z = 4\pi$, $c_{\mathrm{EHZ}} = 4$, $e = 4$, $c_k^{\mathrm{EH}} = 4k$ |
| Cross-polytope $O_{2n}$ | $\{x : \|x\|_1 \leq 1\}$ | any $n$ | $c_B = \pi$, $c_{\mathrm{EHZ}} = 4$, $c_Z = 4\pi$, $e = 4$ |
| Product box $B(\alpha,\beta)$ | $\prod_{j=1}^n [-\alpha_j,\alpha_j] \times [-\beta_j,\beta_j]$ | any $n$ | $c_B = 4\pi \min_j \alpha_j \beta_j$, $c_Z = 4\pi \max_j \alpha_j \beta_j$ |
| Delzant simplex $\Delta_4$ | Convex hull of $(0,0,0,0)$, $e_1, e_2, e_3, (1,1,1,1)$ | $4$ | $c_B = \pi$, $c_{\mathrm{EHZ}} = \pi$, $c_k^{\mathrm{SH}} = k\pi$ |
| 4D Hanner polytope | Minkowski sum of square and diamond | $4$ | $c_{\mathrm{EHZ}}=4$, $c_2^{\mathrm{EH}}=8$, $\delta^{\mathrm{SBM}}$ with cube $=1$ |

## References

* Artstein-Avidan, S. & Ostrover, Y. (2008). *A Brunn–Minkowski inequality for symplectic capacities of convex bodies*. Duke Math. J. **130**(2), 319–339.
* Artstein-Avidan, S., Karasev, R., & Ostrover, Y. (2014). *From symplectic ball packing to a Mahler-type inequality*. Geom. Funct. Anal. **22**, 1011–1039.
* Artstein-Avidan, S. & Ostrover, Y. (2015). *Symplectic Banach–Mazur distances*. Adv. Math. **304**, 88–137.
* Cieliebak, K., Frauenfelder, U., & Paternain, G. (2009). *Symplectic topology of Mañé’s critical values*. Geom. Funct. Anal. **18**, 1549–1595.
* Cristofaro-Gardiner, D., Hutchings, M., & Ramos, V. G. B. (2017). *The asymptotics of ECH capacities*. Invent. Math. **199**, 187–214.
* Gromov, M. (1985). *Pseudo holomorphic curves in symplectic manifolds*. Invent. Math. **82**, 307–347.
* Gutkin, E. & Tabachnikov, S. (2003). *Billiards in Finsler and Minkowski geometries*. J. Geom. Phys. **40**, 277–301.
* Hofer, H. & Zehnder, E. (1994). *Symplectic invariants and Hamiltonian dynamics*. Birkhäuser.
* Hutchings, M. (2011). *Quantitative embedded contact homology*. J. Differential Geom. **88**, 231–266.
* Lu, G. (2006). *Gromov-Witten invariants and pseudo symplectic capacity*. Ann. of Math. **163**, 299–347.
* Ostrover, Y. & Tyomkin, I. (2015). *On the quantum homology algebra of toric Fano manifolds*. Selecta Math. **21**, 1211–1242.
* Schlenk, F. (2005). *Embedding problems in symplectic geometry*. De Gruyter.
* Siburg, K. (1991). *Action minimizing orbits in symplectic dynamics*. In *Geometry of Hamiltonian systems*, MSRI Publ. **22**, 259–273.
