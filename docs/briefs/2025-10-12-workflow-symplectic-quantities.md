---
status: adopted
created: 2025-10-12
workflow: workflow
summary: Reference symplectic invariants and computation notes for convex polytopes in even dimensions.
---

# Workflow: Symplectic Quantities for Convex Polytopes

## Context

- Focus: convex polytopes $P \subset (\mathbb{R}^{2n}, \omega_0)$ with facet presentation $P = \{ x : A x \le b \}$.
- We already implement the Ekeland–Hofer–Zehnder (EHZ) capacity $c_{\mathrm{EHZ}}$ and volume; other invariants appear on the roadmap.
- Audience: contributors comfortable with symplectic/contact topology and algorithmic implementations.

## Quick reference table

| Quantity | Definition sketch | Key facts | Algorithmic notes |
| -------- | ----------------- | --------- | ----------------- |
| Gromov width $c_B$ | Maximal ball that symplectically embeds into $P$ | Monotone, $c_B(P)^n \le n!\, \operatorname{vol}(P)$ (Viterbo) | Optimisation over $\mathrm{Sp}(2n)$; axis-aligned relaxations give lower bounds. |
| Cylindrical capacity $c_Z$ | Smallest cylinder $Z^{2n}(R) = B^2(R) \times \mathbb{R}^{2n-2}$ containing a symplectic image of $P$ | $c_B \le c_Z$; equals minimal area of projections onto symplectic 2-planes | Reduce to optimisation over unit vectors $u$ with $h_P(u)$ and $h_P(Ju)$. |
| Hofer–Zehnder capacity $c_{\mathrm{HZ}}$ | Supremal action of admissible Hamiltonians | Equals $c_{\mathrm{EHZ}}$ for convex $P$ | Implemented via Minkowski billiards in `viterbo.math.capacity`. |
| Higher Ekeland–Hofer capacities $c_k$ | Action spectrum ordered increasingly | Provide sharper embedding obstructions | Enumerate Minkowski billiard words; reuse Reeb cycles. |
| Viterbo/Symplectic homology capacities $c_k^{\mathrm{SH}}$ | Spectral invariants in positive $S^1$-equivariant symplectic homology | Obey Viterbo inequality; coincide with EHZ for $k=1$ | Toric cases via lattice paths; general cases via Floer-theoretic persistence. |
| Embedded Contact Homology (ECH) capacities (4D) | Sequence from ECH of $\partial P$ | Sharp obstructions in $\mathbb{C}^2$; equals EH for convex toric domains | Hutchings’ lattice-path algorithm for toric polytopes. |
| Displacement energy $e(P)$ | Hofer energy to displace $P$ | $c_B(P) \le e(P) \le c_Z(P)$ | For convex $P$, equals support function of $P-P$ evaluated on $J$-images of facet normals. |
| Symplectic Banach–Mazur distance $\delta^{\mathrm{SBM}}$ | Minimal $\lambda$ with $P \subseteq \phi(Q) \subseteq \lambda P$ up to symplectomorphisms | Metric on convex bodies modulo scaling | Formulate as (mixed) optimisation over $\mathrm{Sp}(2n)$ embeddings. |

## Notes by invariant

### 1. Gromov width $c_B$

- Definition: $ c_B(P) = \sup \{ \pi r^2 : \exists S \in \mathrm{Sp}(2n),\ S(B^{2n}(r)) \subseteq P \} $.
- Lower bounds from block-diagonal $S$ reduce to convex programmes over log-scalings. Exact formulas exist for orthotopes.
- Optimise via Riemannian gradient ascent on $\mathrm{Sp}(2n)$ or by enumerating symmetry-reduced candidates.

### 2. Cylindrical capacity $c_Z$

- Equals the minimal symplectic area of a shadow of $P$ onto a symplectic 2-plane.
- For centrally symmetric $P$, the minimising plane is generated by opposite facet normals under $J$.
- Implementation: enumerate candidate facet pairs, solve for optimal $u$, and compute resulting $\pi R^2$.

### 3. Hofer–Zehnder and higher Ekeland–Hofer capacities

- $c_{\mathrm{HZ}} = c_{\mathrm{EHZ}}$ for convex $P$; higher $c_k^{\mathrm{EH}}$ correspond to ordered closed characteristics.
- Minkowski billiards give a discrete route: enumerate facet words, solve complementarity conditions, and compute actions.
- Tests reside in `tests/viterbo/test_capacity.py`, `tests/viterbo/test_capacity_area_property.py`, and related fixtures.

### 4. Symplectic-homology capacities $c_k^{\mathrm{SH}}$

- Defined via filtered positive $S^1$-equivariant symplectic homology.
- For toric domains, reduce to lattice-path enumeration; for general polytopes, consider persistence-based approximations.

### 5. ECH capacities (4D)

- Provide sharp embedding obstructions in $\mathbb{C}^2$ and align with EH capacities on convex toric domains.
- Hutchings’ lattice-path algorithm enumerates admissible paths; integrate with toric polytope moment maps.

### 6. Displacement energy and symplectic Banach–Mazur distance

- Displacement energy uses support functions of $P-P$ evaluated on $J$-images of facet normals.
- Symplectic Banach–Mazur distance leads to mixed-integer formulations over symplectic embeddings.

## Acceptance

- Reference stays aligned with implemented APIs and test fixtures; invariants not yet implemented list their roadmap status.
- Examples and algorithms referenced here match citations captured in capacity/volume briefs.

## Status Log

- 2025-02-14 — Migrated `docs/13-symplectic-quantities.md` into the briefs tree and cross-linked algorithm briefs.
