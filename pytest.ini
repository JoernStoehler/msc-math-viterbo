[pytest]
testpaths = tests
addopts = -q --timeout-method=signal --session-timeout=120 --durations=15 --durations-min=0.05 --maxfail=1 -m "not deep and not longhaul"
norecursedirs = tests/performance
markers =
    benchmark: marks tests that exercise pytest-benchmark fixtures.
    line_profile: profile annotated tests with line_profiler.
    slow: marks tests that are slower and excluded from fast loops.
    smoke: default CI/local tier (<5 min); auto-applied unless overridden.
    deep: extended coverage tier (5-20 min) for pre-merge validation.
    longhaul: scheduled tier (>1 h) for manual runs.
filterwarnings =
    ignore:Passing arguments 'a', 'a_min' or 'a_max' to jax.numpy.clip is deprecated.:DeprecationWarning:jax._src.linear_util
