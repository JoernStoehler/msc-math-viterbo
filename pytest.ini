[pytest]
testpaths = tests
addopts = -q -ra --maxfail=1 --strict-markers --timeout-method=signal --session-timeout=120 --durations=15 --durations-min=0.05 --import-mode=importlib -m "not deep and not longhaul"
norecursedirs = tests/performance
pythonpath = .
markers =
    benchmark: marks tests that exercise pytest-benchmark fixtures.
    line_profile: profile annotated tests with line_profiler.
    slow: marks tests that are slower and excluded from fast loops.
    smoke: default CI/local tier (<5 min); auto-applied unless overridden.
    deep: extended coverage tier (5-20 min) for pre-merge validation.
    longhaul: scheduled tier (>1 h) for manual runs.
    gpu: requires GPU acceleration and is skipped in FAST mode.
    jit: requires JAX JIT and is skipped in FAST mode.
    integration: touches external systems and is skipped in FAST mode.
    goal_math: validates mathematical properties or invariants.
    goal_code: validates implementation-level behaviour and error handling.
    goal_performance: measures runtime characteristics or throughput.
filterwarnings =
    error::DeprecationWarning
    ignore:Passing arguments 'a', 'a_min' or 'a_max' to jax.numpy.clip is deprecated.:DeprecationWarning
